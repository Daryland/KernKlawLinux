#!/usr/bin/make -f
# Debian packaging rules for kernklaw-linux

export DH_VERBOSE = 1
export DEB_BUILD_MAINT_OPTIONS = hardening=+all

%:
	dh $@ --buildsystem=cmake

override_dh_auto_configure:
	dh_auto_configure -- \
	    -DCMAKE_BUILD_TYPE=Release \
	    -DBUILD_EBPF=OFF \
	    -DCMAKE_INSTALL_PREFIX=/usr/local

override_dh_auto_build:
	dh_auto_build

override_dh_fixperms:
	dh_fixperms
	# Set setuid on sandboxed executor
	chmod 4755 debian/kernklaw-linux/usr/local/bin/claw-skill-exec

override_dh_installsystemd:
	dh_installsystemd --name=claw-daemon --no-start
